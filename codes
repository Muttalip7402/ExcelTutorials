'arrays
'general-------diziler

Option Base 1
---------------
Sub diziler()
ReDim dizi(20)

For i = 1 To 20
dizi(i) = Cells(i, 1)
Next i

a = dizi(5)

End Sub

'create a function (must be created in a module

(Genaral) ----- carp
--------
Public Function carp(a As Range, b As Range, c As Range)

carp = a * b * c

End Function

'IF THEN ELSE

CommandButton1-----Click
---------------
Private Sub CommandButton1_Click()
a = Range("E2")

If a < 31 Then
Range("G4") = "FF"

ElseIf a >= 31 And a < 51 Then
Range("G4") = "DD"

ElseIf a >= 51 And a < 71 Then
Range("G4") = "CC"

ElseIf a >= 71 And a < 91 Then
Range("G4") = "BB"

Else
Range("G4") = "AA"

End If
End Sub

'FOR NEXT
(General)------donguler
-------------
Sub donguler()

For i = 1 To 22

If Cells(i, 1) > 30 Then Cells(i, 2) = Cells(i, 1) / 2

Next i

End Sub

'Do While
(Genaral)-------------dowhiletrue
---------
Sub dowhiletrue()

i = 0
Do While True
i = i + 1

Cells(i, 1) = i
If i = 10 Then
Exit Do
End If

Loop

End Sub

'Do Until Loop
CommandButton1-----click
------------
Private Sub CommandButton1_Click()
i = 1

Do Until i > 5
Cells(i, 1) = i
i = i + 1
Loop


End Sub

'FOR EACH
(General)------foreach
-------------
Sub foreach()
Dim sayfa As Worksheet
Dim sekmesayisi As Integer

sekmesayisi = 100
Worksheets.Add Count:=sekmesayisi
i = 1
For Each sayfa In Worksheets
sayfa.Name = "MMB" & i
i = i + 1
'bu kod sayfayi korur
'sayfa.Protect
'sayfa.Unprotect



Next sayfa

End Sub

'SELECT CASE
(General)------selectcase
-------------
Sub selectcase()

For i = 3 To 361
a = Cells(i, 7)

Select Case a
Case 0 To 30: Cells(i, 8) = "FF"
Case 31 To 50: Cells(i, 8) = "DD"
Case 51 To 70: Cells(i, 8) = "CC"
Case 71 To 90: Cells(i, 8) = "BB"
Case 91 To 100: Cells(i, 8) = "AA"
End Select

Next i

End Sub
 
 'Do Events
 CommandButton1-----Click
------------
Private Sub CommandButton1_Click()

For i = 1 To 1000000
DoEvents
Cells(i, 1) = i
Next i


End Sub

'VLookup in vba
(General)------duseyara
-------------
Sub duseyara()

a = Range("H2")

Range("I2") = Application.WorksheetFunction.VLookup(a, Range("A:B"), 2, 0)


End Sub

'Sumifs in vba
(General)------sumifs
-------------
Sub coketopla()

a = Range("H6")
b = Range("I6")

Range("J6") = Application.WorksheetFunction.SumIfs(Range("C:C"), Range("A:A"), a, Range("D:D"), b)

End Sub

-----------------
CommandButton1-----Click
------------
Private Sub CommandButton1_Click()

For i = 2 To 10

Cells(i, 3) = Application.WorksheetFunction.SumIfs(Sheets("HAM").Range("C:C"), Sheets("HAM").Range("A:A"), Cells(i, 1))

Next i


Range("C11") = Application.WorksheetFunction.Sum(Range("C2:C10"))
Range("C12") = Application.WorksheetFunction.Average(Range("C2:C10"))
Range("C13") = Application.WorksheetFunction.Min(Range("C2:C10"))
Range("C14") = Application.WorksheetFunction.Max(Range("C2:C10"))

End Sub


'Mause Over in module

Public Function mouseover(deger As Range)

Sheets("Sheet1").Cells(1, 1) = deger

End Function

'SELECTION CHANGE
Private Sub worksheet_selectionchange(ByVal secim As Range)
'if ile tablo disi seçilmemesini de anlat
Range("A1") = secim.Value

End Sub

'MAKE YOUR OWN FONCTIONS AS ADD IN

Function RenkToplami(aralik As Range, hucre As Range)

Sayi = aralik.Count

Dim toplam As Double

toplam = 0

For i = 1 To Sayi

If aralik(i).Interior.ColorIndex = hucre.Interior.ColorIndex Then

toplam = toplam + aralik(i).Value

End If

Next i

RenkToplami = toplam

End Function

Function YuzdeKac(aralik As Range, yuzde As Range)

Dim toplam As Double

toplam = Application.WorksheetFunction.Sum(aralik)

YuzdeKac = yuzde / toplam

End Function

Function MinimumBul(aralik As Range)

MinimumBul = Application.WorksheetFunction.min(aralik)

End Function

'CREATE BRIEFLIST BY USING MACRO (MAKRO ILE OZET LISTE OLUŞTURMAK)

Private Sub CommandButton1_Click()
Range("I2:J1000").ClearContents
tarih = Range("H2")

sonsatir = Cells(Rows.Count, "A").End(xlUp).Row

For i = 2 To sonsatir
    dongu = Application.WorksheetFunction.CountIf(Range("I:I"), "<>") + 1
    If Cells(i, 2) = tarih Then
    Cells(dongu, 9) = Cells(i, 1)
    Cells(dongu, 10) = Cells(i, 3)
    End If
Next i


End Sub

'fILTER WHEN WRETTING (YAZARKEN FILTRE OLUŞURMAK)
Private Sub TextBox1_Change()

    Selection.AutoFilter
    ActiveSheet.Range("$A$3:$A$84").AutoFilter Field:=1, Criteria1:=TextBox1.Value & "*", _
        Operator:=xlAnd

End Sub

'BLOCK DOUBLE ENTRY (MÜKERRER KAYDIN ENGELLENMESİ)
Private Sub Worksheet_SelectionChange(ByVal Target As Range)

For i = 1000 To 1 Step -1

If WorksheetFunction.CountIf(Range("A2:A" & i), Cells(i, 1)) > 1 Then Rows(i).Delete

Next i

End Sub

'VBE NESTED LOOP (İÇ İÇE DÖNGÜ OLUŞTURMAK)

Private Sub CommandButton1_Click()
sonsatir = Cells(Rows.Count, "H").End(xlUp).Row

For i = 2 To sonsatir
    
    For y = 9 To 13
    Cells(i, y) = WorksheetFunction.SumIfs(Range("B:B"), Range("A:A"), Cells(i, 8), _
    Range("C:C"), Cells(1, y))
    Next y

Next i


End Sub

'ADD ODD AND EVEN NUMBERS (TEK VE ÇİFT SAYILARI TOPLAMAK)

Private Sub CommandButton1_Click()

For i = 1 To 30
If i Mod 2 = 0 Then
cifttoplam = cifttoplam + i
Else
tektoplam = tektoplam + i
End If
Next i

MsgBox "Tek sayilarin toplami=" & " " & tektoplam _
& vbCr & "Cift sayilarin toplami=" & " " & cifttoplam _
, vbInformation

End Sub

'VBE CASCADING WITH ARRAY (ARRAY İLE CASCADİNG OLUŞTURMAK)

Option Base 1
Private Sub Worksheet_SelectionChange(ByVal Target As Range)
sonsatir = WorksheetFunction.CountIf(Range("A:A"), "<>")
kactane = WorksheetFunction.CountIf(Range("A:A"), Range("F1"))
ReDim dizi(kactane) As Variant

y = 1

For i = 1 To sonsatir

If Cells(i, 1) = Range("F1") Then dizi(y) = Cells(i, 2)
If Cells(i, 1) = Range("F1") Then y = y + 1

Next i

ListBox1.List = dizi
End Sub


